(function(){var v=0,q=[],o={},s={},A={"<":"lt",">":"gt","&":"amp",'"':"quot","'":"#39"},p=/[<>&\"\']/g,z,y=window.setTimeout,x={},w;function t(){this.returnValue=false}function r(){this.cancelBubble=true}(function(e){var d=e.split(/,/),c,a,b;for(c=0;c<d.length;c+=2){b=d[c+1].split(/ /);for(a=0;a<b.length;a++){s[b[a]]=d[c]}}})("application/msword,doc dot,application/pdf,pdf,application/pgp-signature,pgp,application/postscript,ps ai eps,application/rtf,rtf,application/vnd.ms-excel,xls xlb,application/vnd.ms-powerpoint,ppt pps pot,application/zip,zip,application/x-shockwave-flash,swf swfl,application/vnd.openxmlformats-officedocument.wordprocessingml.document,docx,application/vnd.openxmlformats-officedocument.wordprocessingml.template,dotx,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,xlsx,application/vnd.openxmlformats-officedocument.presentationml.presentation,pptx,application/vnd.openxmlformats-officedocument.presentationml.template,potx,application/vnd.openxmlformats-officedocument.presentationml.slideshow,ppsx,application/x-javascript,js,application/json,json,audio/mpeg,mpga mpega mp2 mp3,audio/x-wav,wav,audio/mp4,m4a,image/bmp,bmp,image/gif,gif,image/jpeg,jpeg jpg jpe,image/photoshop,psd,image/png,png,image/svg+xml,svg svgz,image/tiff,tiff tif,text/plain,asc txt text diff log,text/html,htm html xhtml,text/css,css,text/csv,csv,text/rtf,rtf,video/mpeg,mpeg mpg mpe,video/quicktime,qt mov,video/mp4,mp4,video/x-m4v,m4v,video/x-flv,flv,video/x-ms-wmv,wmv,video/avi,avi,video/webm,webm,video/vnd.rn-realvideo,rv,application/vnd.oasis.opendocument.formula-template,otf,application/octet-stream,exe");var u={VERSION:"1.5.4",STOPPED:1,STARTED:2,QUEUED:1,UPLOADING:2,FAILED:4,DONE:5,GENERIC_ERROR:-100,HTTP_ERROR:-200,IO_ERROR:-300,SECURITY_ERROR:-400,INIT_ERROR:-500,FILE_SIZE_ERROR:-600,FILE_EXTENSION_ERROR:-601,IMAGE_FORMAT_ERROR:-700,IMAGE_MEMORY_ERROR:-701,IMAGE_DIMENSIONS_ERROR:-702,mimeTypes:s,ua:(function(){var b=navigator,c=b.userAgent,a=b.vendor,e,f,d;e=/WebKit/.test(c);d=e&&a.indexOf("Apple")!==-1;f=window.opera&&window.opera.buildNumber;return{windows:navigator.platform.indexOf("Win")!==-1,ie:!e&&!f&&(/MSIE/gi).test(c)&&(/Explorer/gi).test(b.appName),webkit:e,gecko:!e&&/Gecko/.test(c),safari:d,opera:!!f}}()),typeOf:function(a){return({}).toString.call(a).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()},extend:function(a){u.each(arguments,function(c,b){if(b>0){u.each(c,function(d,e){a[e]=d})}});return a},cleanName:function(c){var b,a;a=[/[\300-\306]/g,"A",/[\340-\346]/g,"a",/\307/g,"C",/\347/g,"c",/[\310-\313]/g,"E",/[\350-\353]/g,"e",/[\314-\317]/g,"I",/[\354-\357]/g,"i",/\321/g,"N",/\361/g,"n",/[\322-\330]/g,"O",/[\362-\370]/g,"o",/[\331-\334]/g,"U",/[\371-\374]/g,"u"];for(b=0;b<a.length;b+=2){c=c.replace(a[b],a[b+1])}c=c.replace(/\s+/g,"_");c=c.replace(/[^a-z0-9_\-\.]+/gi,"");return c},addRuntime:function(b,a){a.name=b;q[b]=a;q.push(a);return a},guid:function(){var b=new Date().getTime().toString(32),a;for(a=0;a<5;a++){b+=Math.floor(Math.random()*65535).toString(32)}return(u.guidPrefix||"p")+b+(v++).toString(32)},buildUrl:function(b,c){var a="";u.each(c,function(d,e){a+=(a?"&":"")+encodeURIComponent(e)+"="+encodeURIComponent(d)});if(a){b+=(b.indexOf("?")>0?"&":"?")+a}return b},each:function(b,a){var c,d,e;if(b){c=b.length;if(c===z){for(d in b){if(b.hasOwnProperty(d)){if(a(b[d],d)===false){return}}}}else{for(e=0;e<c;e++){if(a(b[e],e)===false){return}}}}},formatSize:function(a){if(a===z||/\D/.test(a)){return u.translate("N/A")}if(a>1073741824){return Math.round(a/1073741824,1)+" GB"}if(a>1048576){return Math.round(a/1048576,1)+" MB"}if(a>1024){return Math.round(a/1024,1)+" KB"}return a+" b"},getPos:function(c,h){var g=0,j=0,e,f=document,b,a;c=c;h=h||f.body;function d(n){var k,E,m=0,l=0;if(n){E=n.getBoundingClientRect();k=f.compatMode==="CSS1Compat"?f.documentElement:f.body;m=E.left+k.scrollLeft;l=E.top+k.scrollTop}return{x:m,y:l}}if(c&&c.getBoundingClientRect&&((navigator.userAgent.indexOf("MSIE")>0)&&(f.documentMode<8))){b=d(c);a=d(h);return{x:b.x-a.x,y:b.y-a.y}}e=c;while(e&&e!=h&&e.nodeType){g+=e.offsetLeft||0;j+=e.offsetTop||0;e=e.offsetParent}e=c.parentNode;while(e&&e!=h&&e.nodeType){g-=e.scrollLeft||0;j-=e.scrollTop||0;e=e.parentNode}return{x:g,y:j}},getSize:function(a){return{w:a.offsetWidth||a.clientWidth,h:a.offsetHeight||a.clientHeight}},parseSize:function(b){var a;if(typeof(b)=="string"){b=/^([0-9]+)([mgk]?)$/.exec(b.toLowerCase().replace(/[^0-9mkg]/g,""));a=b[2];b=+b[1];if(a=="g"){b*=1073741824}if(a=="m"){b*=1048576}if(a=="k"){b*=1024}}return b},xmlEncode:function(a){return a?(""+a).replace(p,function(b){return A[b]?"&"+A[b]+";":b}):a},toArray:function(a){var b,c=[];for(b=0;b<a.length;b++){c[b]=a[b]}return c},inArray:function(b,a){if(a){if(Array.prototype.indexOf){return Array.prototype.indexOf.call(a,b)}for(var d=0,c=a.length;d<c;d++){if(a[d]===b){return d}}}return -1},addI18n:function(a){return u.extend(o,a)},translate:function(a){return o[a]||a},isEmptyObj:function(b){if(b===z){return true}for(var a in b){return false}return true},hasClass:function(a,b){var c;if(a.className==""){return false}c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");return c.test(a.className)},addClass:function(a,b){if(!u.hasClass(a,b)){a.className=a.className==""?b:a.className.replace(/\s+$/,"")+" "+b}},removeClass:function(a,b){var c=new RegExp("(^|\\s+)"+b+"(\\s+|$)");a.className=a.className.replace(c,function(e,f,d){return f===" "&&d===" "?" ":""})},getStyle:function(a,b){if(a.currentStyle){return a.currentStyle[b]}else{if(window.getComputedStyle){return window.getComputedStyle(a,null)[b]}}},addEvent:function(b,g,a){var c,d,e,f;f=arguments[3];g=g.toLowerCase();if(w===z){w="Plupload_"+u.guid()}if(b.addEventListener){c=a;b.addEventListener(g,c,false)}else{if(b.attachEvent){c=function(){var h=window.event;if(!h.target){h.target=h.srcElement}h.preventDefault=t;h.stopPropagation=r;a(h)};b.attachEvent("on"+g,c)}}if(b[w]===z){b[w]=u.guid()}if(!x.hasOwnProperty(b[w])){x[b[w]]={}}d=x[b[w]];if(!d.hasOwnProperty(g)){d[g]=[]}d[g].push({func:c,orig:a,key:f})},removeEvent:function(b,g){var d,a,e;if(typeof(arguments[2])=="function"){a=arguments[2]}else{e=arguments[2]}g=g.toLowerCase();if(b[w]&&x[b[w]]&&x[b[w]][g]){d=x[b[w]][g]}else{return}for(var f=d.length-1;f>=0;f--){if(d[f].key===e||d[f].orig===a){if(b.removeEventListener){b.removeEventListener(g,d[f].func,false)}else{if(b.detachEvent){b.detachEvent("on"+g,d[f].func)}}d[f].orig=null;d[f].func=null;d.splice(f,1);if(a!==z){break}}}if(!d.length){delete x[b[w]][g]}if(u.isEmptyObj(x[b[w]])){delete x[b[w]];try{delete b[w]}catch(c){b[w]=z}}},removeAllEvents:function(a){var b=arguments[1];if(a[w]===z||!a[w]){return}u.each(x[a[w]],function(c,d){u.removeEvent(a,d,b)})}};u.Uploader=function(d){var g={},a,b=[],e,f=false;a=new u.QueueProgress();d=u.extend({chunk_size:0,multipart:true,multi_selection:true,file_data_name:"file",filters:[]},d);function c(){var j,l=0,k;if(this.state==u.STARTED){for(k=0;k<b.length;k++){if(!j&&b[k].status==u.QUEUED){j=b[k];j.status=u.UPLOADING;if(this.trigger("BeforeUpload",j)){this.trigger("UploadFile",j)}}else{l++}}if(l==b.length){this.stop();this.trigger("UploadComplete",b)}}}function h(){var j,k;a.reset();for(j=0;j<b.length;j++){k=b[j];if(k.size!==z){a.size+=k.size;a.loaded+=k.loaded}else{a.size=z}if(k.status==u.DONE){a.uploaded++}else{if(k.status==u.FAILED){a.failed++}else{a.queued++}}}if(a.size===z){a.percent=b.length>0?Math.ceil(a.uploaded/b.length*100):0}else{a.bytesPerSec=Math.ceil(a.loaded/((+new Date()-e||1)/1000));a.percent=a.size>0?Math.ceil(a.loaded/a.size*100):0}}u.extend(this,{state:u.STOPPED,runtime:"",features:{},files:b,settings:d,total:a,id:u.guid(),init:function(){var E=this,n,D,k,j=0,m;if(typeof(d.preinit)=="function"){d.preinit(E)}else{u.each(d.preinit,function(B,C){E.bind(C,B)})}d.page_url=d.page_url||document.location.pathname.replace(/\/[^\/]+$/g,"/");if(!/^(\w+:\/\/|\/)/.test(d.url)){d.url=d.page_url+d.url}d.chunk_size=u.parseSize(d.chunk_size);d.max_file_size=u.parseSize(d.max_file_size);E.bind("FilesAdded",function(O,L){var M,N,C=0,B,K=d.filters;if(K&&K.length){B=[];u.each(K,function(F){u.each(F.extensions.split(/,/),function(G){if(/^\s*\*\s*$/.test(G)){B.push("\\.*")}else{B.push("\\."+G.replace(new RegExp("["+("/^$.*+?|()[]{}\\".replace(/./g,"\\$&"))+"]","g"),"\\$&"))}})});B=new RegExp(B.join("|")+"$","i")}for(M=0;M<L.length;M++){N=L[M];N.loaded=0;N.percent=0;N.status=u.QUEUED;if(B&&!B.test(N.name)){O.trigger("Error",{code:u.FILE_EXTENSION_ERROR,message:u.translate("File extension error."),file:N});continue}if(N.size!==z&&N.size>d.max_file_size){O.trigger("Error",{code:u.FILE_SIZE_ERROR,message:u.translate("File size error."),file:N});continue}b.push(N);C++}if(C){y(function(){E.trigger("QueueChanged");E.refresh()},1)}else{return false}});if(d.unique_names){E.bind("UploadFile",function(I,H){var B=H.name.match(/\.([^.]+)$/),C="tmp";if(B){C=B[1]}H.target_name=H.id+"."+C})}E.bind("UploadProgress",function(C,B){B.percent=B.size>0?Math.ceil(B.loaded/B.size*100):100;h()});E.bind("StateChanged",function(B){if(B.state==u.STARTED){e=(+new Date())}else{if(B.state==u.STOPPED){for(n=B.files.length-1;n>=0;n--){if(B.files[n].status==u.UPLOADING){B.files[n].status=u.QUEUED;h()}}}}});E.bind("QueueChanged",h);E.bind("Error",function(C,B){if(B.file){B.file.status=u.FAILED;h();if(C.state==u.STARTED){y(function(){c.call(E)},1)}}});E.bind("FileUploaded",function(C,B){B.status=u.DONE;B.loaded=B.size;C.trigger("UploadProgress",B);y(function(){c.call(E)},1)});if(d.runtimes){D=[];m=d.runtimes.split(/\s?,\s?/);for(n=0;n<m.length;n++){if(q[m[n]]){D.push(q[m[n]])}}}else{D=q}function l(){var B=D[j++],C,I,H;if(B){C=B.getFeatures();I=E.settings.required_features;if(I){I=I.split(",");for(H=0;H<I.length;H++){if(!C[I[H]]){l();return}}}B.init(E,function(F){if(F&&F.success){E.features=C;E.runtime=B.name;E.trigger("Init",{runtime:B.name});E.trigger("PostInit");E.refresh()}else{l()}})}else{E.trigger("Error",{code:u.INIT_ERROR,message:u.translate("Init error.")})}}l();if(typeof(d.init)=="function"){d.init(E)}else{u.each(d.init,function(B,C){E.bind(C,B)})}},refresh:function(){this.trigger("Refresh")},start:function(){if(b.length&&this.state!=u.STARTED){this.state=u.STARTED;this.trigger("StateChanged");c.call(this)}},stop:function(){if(this.state!=u.STOPPED){this.state=u.STOPPED;this.trigger("CancelUpload");this.trigger("StateChanged")}},disableBrowse:function(){f=arguments[0]!==z?arguments[0]:true;this.trigger("DisableBrowse",f)},getFile:function(j){var k;for(k=b.length-1;k>=0;k--){if(b[k].id===j){return b[k]}}},removeFile:function(j){var k;for(k=b.length-1;k>=0;k--){if(b[k].id===j.id){return this.splice(k,1)[0]}}},splice:function(l,k){var j;j=b.splice(l===z?0:l,k===z?b.length:k);this.trigger("FilesRemoved",j);this.trigger("QueueChanged");return j},trigger:function(j){var l=g[j.toLowerCase()],m,k;if(l){k=Array.prototype.slice.call(arguments);k[0]=this;for(m=0;m<l.length;m++){if(l[m].func.apply(l[m].scope,k)===false){return false}}}return true},hasEventListener:function(j){return !!g[j.toLowerCase()]},bind:function(k,m,j){var l;k=k.toLowerCase();l=g[k]||[];l.push({func:m,scope:j||this});g[k]=l},unbind:function(k){k=k.toLowerCase();var l=g[k],j,m=arguments[1];if(l){if(m!==z){for(j=l.length-1;j>=0;j--){if(l[j].func===m){l.splice(j,1);break}}}else{l=[]}if(!l.length){delete g[k]}}},unbindAll:function(){var j=this;u.each(g,function(l,k){j.unbind(k)})},destroy:function(){this.stop();this.trigger("Destroy");this.unbindAll()}})};u.File=function(a,c,b){var d=this;d.id=a;d.name=c;d.size=b;d.loaded=0;d.percent=0;d.status=0};u.Runtime=function(){this.getFeatures=function(){};this.init=function(b,a){}};u.QueueProgress=function(){var a=this;a.size=0;a.loaded=0;a.uploaded=0;a.failed=0;a.queued=0;a.percent=0;a.bytesPerSec=0;a.reset=function(){a.size=a.loaded=a.uploaded=a.failed=a.queued=a.percent=a.bytesPerSec=0}};u.runtimes={};window.plupload=u})();(function(l,h,n,m){var j={},k={};function o(){var c;try{c=navigator.plugins["Shockwave Flash"];c=c.description}catch(a){try{c=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(b){c="0.0"}}c=c.match(/\d+/g);return parseFloat(c[0]+"."+c[1])}n.flash={trigger:function(a,c,b){setTimeout(function(){var f=j[a],d,e;if(f){f.trigger("Flash:"+c,b)}},0)}};n.runtimes.Flash=n.addRuntime("flash",{getFeatures:function(){return{jpgresize:true,pngresize:true,maxWidth:8091,maxHeight:8091,chunks:true,progress:true,multipart:true,multi_selection:true}},init:function(q,f){var b,a,e=0,d=h.body;if(o()<10){f({success:false});return}k[q.id]=false;j[q.id]=q;b=h.getElementById(q.settings.browse_button);a=h.createElement("div");a.id=q.id+"_flash_container";n.extend(a.style,{position:"absolute",top:"0px",background:q.settings.shim_bgcolor||"transparent",zIndex:99999,width:"100%",height:"100%"});a.className="plupload flash";if(q.settings.container){d=h.getElementById(q.settings.container);if(n.getStyle(d,"position")==="static"){d.style.position="relative"}}d.appendChild(a);(function(){var s,p;s='<object id="'+q.id+'_flash" type="application/x-shockwave-flash" data="'+q.settings.flash_swf_url+'" ';if(n.ua.ie){s+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '}s+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+q.settings.flash_swf_url+'" /><param name="flashvars" value="id='+escape(q.id)+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>';if(n.ua.ie){p=h.createElement("div");a.appendChild(p);p.outerHTML=s;p=null}else{a.innerHTML=s}}());function g(){return h.getElementById(q.id+"_flash")}function c(){if(e++>5000){f({success:false});return}if(k[q.id]===false){setTimeout(c,1)}}c();b=a=null;q.bind("Destroy",function(s){var p;n.removeAllEvents(h.body,s.id);delete k[s.id];delete j[s.id];p=h.getElementById(s.id+"_flash_container");if(p){d.removeChild(p)}});q.bind("Flash:Init",function(){var p={},t;try{g().setFileFilters(q.settings.filters,q.settings.multi_selection)}catch(u){f({success:false});return}if(k[q.id]){return}k[q.id]=true;q.bind("UploadFile",function(y,s){var r=y.settings,x=q.settings.resize||{};g().uploadFile(p[s.id],r.url,{name:s.target_name||s.name,mime:n.mimeTypes[s.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream",chunk_size:r.chunk_size,width:x.width,height:x.height,quality:x.quality,multipart:r.multipart,multipart_params:r.multipart_params||{},file_data_name:r.file_data_name,format:/\.(jpg|jpeg)$/i.test(s.name)?"jpg":"png",headers:r.headers,urlstream_upload:r.urlstream_upload})});q.bind("CancelUpload",function(){g().cancelUpload()});q.bind("Flash:UploadProcess",function(s,w){var r=s.getFile(p[w.id]);if(r.status!=n.FAILED){r.loaded=w.loaded;r.size=w.size;s.trigger("UploadProgress",r)}});q.bind("Flash:UploadChunkComplete",function(y,s){var r,x=y.getFile(p[s.id]);r={chunk:s.chunk,chunks:s.chunks,response:s.text};y.trigger("ChunkUploaded",x,r);if(x.status!==n.FAILED&&y.state!==n.STOPPED){g().uploadNextChunk()}if(s.chunk==s.chunks-1){x.status=n.DONE;y.trigger("FileUploaded",x,{response:s.text})}});q.bind("Flash:SelectFiles",function(B,s){var z,A,r=[],C;for(A=0;A<s.length;A++){z=s[A];C=n.guid();p[C]=z.id;p[z.id]=C;r.push(new n.File(C,z.name,z.size))}if(r.length){q.trigger("FilesAdded",r)}});q.bind("Flash:SecurityError",function(s,r){q.trigger("Error",{code:n.SECURITY_ERROR,message:n.translate("Security error."),details:r.message,file:q.getFile(p[r.id])})});q.bind("Flash:GenericError",function(s,r){q.trigger("Error",{code:n.GENERIC_ERROR,message:n.translate("Generic error."),details:r.message,file:q.getFile(p[r.id])})});q.bind("Flash:IOError",function(s,r){q.trigger("Error",{code:n.IO_ERROR,message:n.translate("IO error."),details:r.message,file:q.getFile(p[r.id])})});q.bind("Flash:ImageError",function(s,r){q.trigger("Error",{code:parseInt(r.code,10),message:n.translate("Image error."),file:q.getFile(p[r.id])})});q.bind("Flash:StageEvent:rollOver",function(w){var s,r;s=h.getElementById(q.settings.browse_button);r=w.settings.browse_button_hover;if(s&&r){n.addClass(s,r)}});q.bind("Flash:StageEvent:rollOut",function(w){var s,r;s=h.getElementById(q.settings.browse_button);r=w.settings.browse_button_hover;if(s&&r){n.removeClass(s,r)}});q.bind("Flash:StageEvent:mouseDown",function(w){var s,r;s=h.getElementById(q.settings.browse_button);r=w.settings.browse_button_active;if(s&&r){n.addClass(s,r);n.addEvent(h.body,"mouseup",function(){n.removeClass(s,r)},w.id)}});q.bind("Flash:StageEvent:mouseUp",function(w){var s,r;s=h.getElementById(q.settings.browse_button);r=w.settings.browse_button_active;if(s&&r){n.removeClass(s,r)}});q.bind("Flash:ExifData",function(s,r){q.trigger("ExifData",q.getFile(p[r.id]),r.data)});q.bind("Flash:GpsData",function(s,r){q.trigger("GpsData",q.getFile(p[r.id]),r.data)});q.bind("QueueChanged",function(r){q.refresh()});q.bind("FilesRemoved",function(w,r){var s;for(s=0;s<r.length;s++){g().removeFile(p[r[s].id])}});q.bind("StateChanged",function(r){q.refresh()});q.bind("Refresh",function(y){var x,s,r;g().setFileFilters(q.settings.filters,q.settings.multi_selection);x=h.getElementById(y.settings.browse_button);if(x){s=n.getPos(x,h.getElementById(y.settings.container));r=n.getSize(x);n.extend(h.getElementById(y.id+"_flash_container").style,{top:s.y+"px",left:s.x+"px",width:r.w+"px",height:r.h+"px"})}});q.bind("DisableBrowse",function(s,r){g().disableBrowse(r)});f({success:true})})}})})(window,document,plupload);(function(r,p,q,u){var w={},s;function n(b,a){var c;if("FileReader" in r){c=new FileReader();c.readAsDataURL(b);c.onload=function(){a(c.result)}}else{return a(b.getAsDataURL())}}function o(b,a){var c;if("FileReader" in r){c=new FileReader();c.readAsBinaryString(b);c.onload=function(){a(c.result)}}else{return a(b.getAsBinary())}}function v(a,c,e,f){var b,d,g,j,h=this;n(w[a.id],function(k){b=p.createElement("canvas");b.style.display="none";p.body.appendChild(b);d=b.getContext("2d");g=new Image();g.onerror=g.onabort=function(){f({success:false})};g.onload=function(){var G,m,E,F,l;if(!c.width){c.width=g.width}if(!c.height){c.height=g.height}j=Math.min(c.width/g.width,c.height/g.height);if(j<1||(j===1&&e==="image/jpeg")){G=Math.round(g.width*j);m=Math.round(g.height*j);b.width=G;b.height=m;d.drawImage(g,0,0,G,m);if(e==="image/jpeg"){F=new t(atob(k.substring(k.indexOf("base64,")+7)));if(F.headers&&F.headers.length){l=new y();if(l.init(F.get("exif")[0])){l.setExif("PixelXDimension",G);l.setExif("PixelYDimension",m);F.set("exif",l.getBinary());if(h.hasEventListener("ExifData")){h.trigger("ExifData",a,l.EXIF())}if(h.hasEventListener("GpsData")){h.trigger("GpsData",a,l.GPS())}}}if(c.quality){try{k=b.toDataURL(e,c.quality/100)}catch(D){k=b.toDataURL(e)}}}else{k=b.toDataURL(e)}k=k.substring(k.indexOf("base64,")+7);k=atob(k);if(F&&F.headers&&F.headers.length){k=F.restore(k);F.purge()}b.parentNode.removeChild(b);f({success:true,data:k})}else{f({success:false})}};g.src=k})}q.runtimes.Html5=q.addRuntime("html5",{getFeatures:function(){var a,e,b,c,d,f;e=b=d=f=false;if(r.XMLHttpRequest){a=new XMLHttpRequest();b=!!a.upload;e=!!(a.sendAsBinary||a.upload)}if(e){c=!!(a.sendAsBinary||(r.Uint8Array&&r.ArrayBuffer));d=!!(File&&(File.prototype.getAsDataURL||r.FileReader)&&c);f=!!(File&&(File.prototype.mozSlice||File.prototype.webkitSlice||File.prototype.slice))}s=q.ua.safari&&q.ua.windows;return{html5:e,dragdrop:(function(){var g=p.createElement("div");return("draggable" in g)||("ondragstart" in g&&"ondrop" in g)}()),jpgresize:d,pngresize:d,multipart:d||!!r.FileReader||!!r.FormData,canSendBinary:c,cantSendBlobInFormData:!!(q.ua.gecko&&r.FormData&&r.FileReader&&!FileReader.prototype.readAsArrayBuffer),progress:b,chunks:f,multi_selection:!(q.ua.safari&&q.ua.windows),triggerDialog:(q.ua.gecko&&r.FormData||q.ua.webkit)}},init:function(c,a){var e,b;function d(g){var j,k,h=[],f,l={};for(k=0;k<g.length;k++){j=g[k];if(l[j.name]){continue}l[j.name]=true;f=q.guid();w[f]=j;h.push(new q.File(f,j.fileName||j.name,j.fileSize||j.size))}if(h.length){c.trigger("FilesAdded",h)}}e=this.getFeatures();if(!e.html5){a({success:false});return}c.bind("Init",function(m){var I,K,g=[],H,f,L=m.settings.filters,J,h,N=p.body,M;I=p.createElement("div");I.id=m.id+"_html5_container";q.extend(I.style,{position:"absolute",background:c.settings.shim_bgcolor||"transparent",width:"100px",height:"100px",overflow:"hidden",zIndex:99,opacity:c.settings.shim_bgcolor?"":0});I.className="plupload html5";if(c.settings.container){N=p.getElementById(c.settings.container);if(q.getStyle(N,"position")==="static"){N.style.position="relative"}}N.appendChild(I);no_type_restriction:for(H=0;H<L.length;H++){J=L[H].extensions.split(/,/);for(f=0;f<J.length;f++){if(J[f]==="*"){g=[];break no_type_restriction}h=q.mimeTypes[J[f]];if(h&&q.inArray(h,g)===-1){g.push(h)}}}I.innerHTML='<input id="'+c.id+'_html5"  style="font-size:999px" type="file" accept="'+g.join(",")+'" '+(c.settings.multi_selection&&c.features.multi_selection?'multiple="multiple"':"")+" />";I.scrollTop=100;M=p.getElementById(c.id+"_html5");if(m.features.triggerDialog){q.extend(M.style,{position:"absolute",width:"100%",height:"100%"})}else{q.extend(M.style,{cssFloat:"right",styleFloat:"right"})}M.onchange=function(){d(this.files);this.value=""};K=p.getElementById(m.settings.browse_button);if(K){var k=m.settings.browse_button_hover,j=m.settings.browse_button_active,l=m.features.triggerDialog?K:I;if(k){q.addEvent(l,"mouseover",function(){q.addClass(K,k)},m.id);q.addEvent(l,"mouseout",function(){q.removeClass(K,k)},m.id)}if(j){q.addEvent(l,"mousedown",function(){q.addClass(K,j)},m.id);q.addEvent(p.body,"mouseup",function(){q.removeClass(K,j)},m.id)}if(m.features.triggerDialog){q.addEvent(K,"click",function(z){var A=p.getElementById(m.id+"_html5");if(A&&!A.disabled){A.click()}z.preventDefault()},m.id)}}});c.bind("PostInit",function(){var f=p.getElementById(c.settings.drop_element);if(f){if(s){q.addEvent(f,"dragenter",function(g){var h,k,j;h=p.getElementById(c.id+"_drop");if(!h){h=p.createElement("input");h.setAttribute("type","file");h.setAttribute("id",c.id+"_drop");h.setAttribute("multiple","multiple");q.addEvent(h,"change",function(){d(this.files);q.removeEvent(h,"change",c.id);h.parentNode.removeChild(h)},c.id);f.appendChild(h)}k=q.getPos(f,p.getElementById(c.settings.container));j=q.getSize(f);if(q.getStyle(f,"position")==="static"){q.extend(f.style,{position:"relative"})}q.extend(h.style,{position:"absolute",display:"block",top:0,left:0,width:j.w+"px",height:j.h+"px",opacity:0})},c.id);return}q.addEvent(f,"dragover",function(g){g.preventDefault()},c.id);q.addEvent(f,"drop",function(g){var h=g.dataTransfer;if(h&&h.files){d(h.files)}g.preventDefault()},c.id)}});c.bind("Refresh",function(l){var k,j,h,f,g;k=p.getElementById(c.settings.browse_button);if(k){j=q.getPos(k,p.getElementById(l.settings.container));h=q.getSize(k);f=p.getElementById(c.id+"_html5_container");q.extend(f.style,{top:j.y+"px",left:j.x+"px",width:h.w+"px",height:h.h+"px"});if(c.features.triggerDialog){if(q.getStyle(k,"position")==="static"){q.extend(k.style,{position:"relative"})}g=parseInt(q.getStyle(k,"z-index"),10);if(isNaN(g)){g=0}q.extend(k.style,{zIndex:g});q.extend(f.style,{zIndex:g-1})}}});c.bind("DisableBrowse",function(h,f){var g=p.getElementById(h.id+"_html5");if(g){g.disabled=f}});c.bind("CancelUpload",function(){if(b&&b.abort){b.abort()}});c.bind("UploadFile",function(l,j){var h=l.settings,m,k;function f(E,F,H){var I;if(File.prototype.slice){try{E.slice();return E.slice(F,H)}catch(G){return E.slice(F,H-F)}}else{if(I=File.prototype.webkitSlice||File.prototype.mozSlice){return I.call(E,F,H)}else{return null}}}function g(E){var F=0,H=0,G=("FileReader" in r)?new FileReader:null;function I(){var D,z,B,A,N,C,P,Q=l.settings.url;function O(J){var L=0,aa="----pluploadboundary"+q.guid(),Z,Y="--",K="\r\n",W="";b=new XMLHttpRequest;if(b.upload){b.upload.onprogress=function(R){j.loaded=Math.min(j.size,H+R.loaded-L);l.trigger("UploadProgress",j)}}b.onreadystatechange=function(){var R,S;if(b.readyState==4&&l.state!==q.STOPPED){try{R=b.status}catch(T){R=0}if(R>=400){l.trigger("Error",{code:q.HTTP_ERROR,message:q.translate("HTTP Error."),file:j,status:R})}else{if(B){S={chunk:F,chunks:B,response:b.responseText,status:R};l.trigger("ChunkUploaded",j,S);H+=C;if(S.cancelled){j.status=q.FAILED;return}j.loaded=Math.min(j.size,(F+1)*N)}else{j.loaded=j.size}l.trigger("UploadProgress",j);J=D=Z=W=null;if(!B||++F>=B){j.status=q.DONE;l.trigger("FileUploaded",j,{response:b.responseText,status:R})}else{I()}}}};if(l.settings.multipart&&e.multipart){A.name=j.target_name||j.name;b.open("post",Q,true);q.each(l.settings.headers,function(S,R){b.setRequestHeader(R,S)});if(typeof(J)!=="string"&&!!r.FormData){Z=new FormData();q.each(q.extend(A,l.settings.multipart_params),function(S,R){Z.append(R,S)});Z.append(l.settings.file_data_name,J);b.send(Z);return}if(typeof(J)==="string"){b.setRequestHeader("Content-Type","multipart/form-data; boundary="+aa);q.each(q.extend(A,l.settings.multipart_params),function(S,R){W+=Y+aa+K+'Content-Disposition: form-data; name="'+R+'"'+K+K;W+=unescape(encodeURIComponent(S))+K});P=q.mimeTypes[j.name.replace(/^.+\.([^.]+)/,"$1").toLowerCase()]||"application/octet-stream";W+=Y+aa+K+'Content-Disposition: form-data; name="'+l.settings.file_data_name+'"; filename="'+unescape(encodeURIComponent(j.name))+'"'+K+"Content-Type: "+P+K+K+J+K+Y+aa+Y+K;L=W.length-J.length;J=W;if(b.sendAsBinary){b.sendAsBinary(J)}else{if(e.canSendBinary){var M=new Uint8Array(J.length);for(var X=0;X<J.length;X++){M[X]=(J.charCodeAt(X)&255)}b.send(M.buffer)}}return}}Q=q.buildUrl(l.settings.url,q.extend(A,l.settings.multipart_params));b.open("post",Q,true);b.setRequestHeader("Content-Type","application/octet-stream");q.each(l.settings.headers,function(S,R){b.setRequestHeader(R,S)});b.send(J)}if(j.status==q.DONE||j.status==q.FAILED||l.state==q.STOPPED){return}A={name:j.target_name||j.name};if(h.chunk_size&&j.size>h.chunk_size&&(e.chunks||typeof(E)=="string")){N=h.chunk_size;B=Math.ceil(j.size/N);C=Math.min(N,j.size-(F*N));if(typeof(E)=="string"){D=E.substring(F*N,F*N+C)}else{D=f(E,F*N,F*N+C)}A.chunk=F;A.chunks=B}else{C=j.size;D=E}if(l.settings.multipart&&e.multipart&&typeof(D)!=="string"&&G&&e.cantSendBlobInFormData&&e.chunks&&l.settings.chunk_size){G.onload=function(){O(G.result)};G.readAsBinaryString(D)}else{O(D)}}I()}m=w[j.id];if(e.jpgresize&&l.settings.resize&&/\.(png|jpg|jpeg)$/i.test(j.name)){v.call(l,j,l.settings.resize,/\.png$/i.test(j.name)?"image/png":"image/jpeg",function(A){if(A.success){j.size=A.data.length;g(A.data)}else{if(e.chunks){g(m)}else{o(m,g)}}})}else{if(!e.chunks&&e.jpgresize){o(m,g)}else{g(m)}}});c.bind("Destroy",function(k){var h,g,j=p.body,f={inputContainer:k.id+"_html5_container",inputFile:k.id+"_html5",browseButton:k.settings.browse_button,dropElm:k.settings.drop_element};for(h in f){g=p.getElementById(f[h]);if(g){q.removeAllEvents(g,k.id)}}q.removeAllEvents(p.body,k.id);if(k.settings.container){j=p.getElementById(k.settings.container)}j.removeChild(p.getElementById(f.inputContainer))});a({success:true})}});function x(){var b=false,d;function a(j,g){var k=b?0:-8*(g-1),f=0,h;for(h=0;h<g;h++){f|=(d.charCodeAt(j+h)<<Math.abs(k+h*8))}return f}function e(f,h,g){var g=arguments.length===3?g:d.length-h-1;d=d.substr(0,h)+f+d.substr(g+h)}function c(k,j,g){var f="",l=b?0:-8*(g-1),h;for(h=0;h<g;h++){f+=String.fromCharCode((j>>Math.abs(l+h*8))&255)}e(f,k,g)}return{II:function(f){if(f===u){return b}else{b=f}},init:function(f){b=false;d=f},SEGMENT:function(h,f,g){switch(arguments.length){case 1:return d.substr(h,d.length-h-1);case 2:return d.substr(h,f);case 3:e(g,h,f);break;default:return d}},BYTE:function(f){return a(f,1)},SHORT:function(f){return a(f,2)},LONG:function(g,f){if(f===u){return a(g,4)}else{c(g,f,4)}},SLONG:function(g){var f=a(g,4);return(f>2147483647?f-4294967296:f)},STRING:function(h,g){var f="";for(g+=h;h<g;h++){f+=String.fromCharCode(a(h,1))}return f}}}function t(c){var a={65505:{app:"EXIF",name:"APP1",signature:"Exif\0"},65506:{app:"ICC",name:"APP2",signature:"ICC_PROFILE\0"},65517:{app:"IPTC",name:"APP13",signature:"Photoshop 3.0\0"}},b=[],d,h,f=u,e=0,g;d=new x();d.init(c);if(d.SHORT(0)!==65496){return}h=2;g=Math.min(1048576,c.length);while(h<=g){f=d.SHORT(h);if(f>=65488&&f<=65495){h+=2;continue}if(f===65498||f===65497){break}e=d.SHORT(h+2)+2;if(a[f]&&d.STRING(h+4,a[f].signature.length)===a[f].signature){b.push({hex:f,app:a[f].app.toUpperCase(),name:a[f].name.toUpperCase(),start:h,length:e,segment:d.SEGMENT(h,e)})}h+=e}d.init(null);return{headers:b,restore:function(A){d.init(A);var k=new t(A);if(!k.headers){return false}for(var j=k.headers.length;j>0;j--){var m=k.headers[j-1];d.SEGMENT(m.start,m.length,"")}k.purge();h=d.SHORT(2)==65504?4+d.SHORT(4):2;for(var j=0,l=b.length;j<l;j++){d.SEGMENT(h,0,b[j].segment);h+=b[j].length}return d.SEGMENT()},get:function(j){var m=[];for(var k=0,l=b.length;k<l;k++){if(b[k].app===j.toUpperCase()){m.push(b[k].segment)}}return m},set:function(A,j){var m=[];if(typeof(j)==="string"){m.push(j)}else{m=j}for(var k=ii=0,l=b.length;k<l;k++){if(b[k].app===A.toUpperCase()){b[k].segment=m[ii];b[k].length=m[ii].length;ii++}if(ii>=m.length){break}}},purge:function(){b=[];d.init(null)}}}function y(){var d,g,f={},a;d=new x();g={tiff:{274:"Orientation",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer"},exif:{36864:"ExifVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",36867:"DateTimeOriginal",33434:"ExposureTime",33437:"FNumber",34855:"ISOSpeedRatings",37377:"ShutterSpeedValue",37378:"ApertureValue",37383:"MeteringMode",37384:"LightSource",37385:"Flash",41986:"ExposureMode",41987:"WhiteBalance",41990:"SceneCaptureType",41988:"DigitalZoomRatio",41992:"Contrast",41993:"Saturation",41994:"Sharpness"},gps:{0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude"}};a={ColorSpace:{1:"sRGB",0:"Uncalibrated"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{1:"Daylight",2:"Fliorescent",3:"Tungsten",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 -5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire.",1:"Flash fired.",5:"Strobe return light not detected.",7:"Strobe return light detected.",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},ExposureMode:{0:"Auto exposure",1:"Manual exposure",2:"Auto bracket"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},GPSLatitudeRef:{N:"North latitude",S:"South latitude"},GPSLongitudeRef:{E:"East longitude",W:"West longitude"}};function e(M,j){var J=d.SHORT(M),m,N,L,k,l,K,I,h,O=[],H={};for(m=0;m<J;m++){I=K=M+12*m+2;L=j[d.SHORT(I)];if(L===u){continue}k=d.SHORT(I+=2);l=d.LONG(I+=2);I+=4;O=[];switch(k){case 1:case 7:if(l>4){I=d.LONG(I)+f.tiffHeader}for(N=0;N<l;N++){O[N]=d.BYTE(I+N)}break;case 2:if(l>4){I=d.LONG(I)+f.tiffHeader}H[L]=d.STRING(I,l-1);continue;case 3:if(l>2){I=d.LONG(I)+f.tiffHeader}for(N=0;N<l;N++){O[N]=d.SHORT(I+N*2)}break;case 4:if(l>1){I=d.LONG(I)+f.tiffHeader}for(N=0;N<l;N++){O[N]=d.LONG(I+N*4)}break;case 5:I=d.LONG(I)+f.tiffHeader;for(N=0;N<l;N++){O[N]=d.LONG(I+N*4)/d.LONG(I+N*4+4)}break;case 9:I=d.LONG(I)+f.tiffHeader;for(N=0;N<l;N++){O[N]=d.SLONG(I+N*4)}break;case 10:I=d.LONG(I)+f.tiffHeader;for(N=0;N<l;N++){O[N]=d.SLONG(I+N*4)/d.SLONG(I+N*4+4)}break;default:continue}h=(l==1?O[0]:O);if(a.hasOwnProperty(L)&&typeof h!="object"){H[L]=a[L][h]}else{H[L]=h}}return H}function b(){var h=u,j=f.tiffHeader;d.II(d.SHORT(j)==18761);if(d.SHORT(j+=2)!==42){return false}f.IFD0=f.tiffHeader+d.LONG(j+=2);h=e(f.IFD0,g.tiff);f.exifIFD=("ExifIFDPointer" in h?f.tiffHeader+h.ExifIFDPointer:u);f.gpsIFD=("GPSInfoIFDPointer" in h?f.tiffHeader+h.GPSInfoIFDPointer:u);return true}function c(k,m,C){var E,D,j,h=0;if(typeof(m)==="string"){var l=g[k.toLowerCase()];for(hex in l){if(l[hex]===m){m=hex;break}}}E=f[k.toLowerCase()+"IFD"];D=d.SHORT(E);for(i=0;i<D;i++){j=E+12*i+2;if(d.SHORT(j)==m){h=j+8;break}}if(!h){return false}d.LONG(h,C);return true}return{init:function(h){f={tiffHeader:10};if(h===u||!h.length){return false}d.init(h);if(d.SHORT(0)===65505&&d.STRING(4,5).toUpperCase()==="EXIF\0"){return b()}return false},EXIF:function(){var j;j=e(f.exifIFD,g.exif);if(j.ExifVersion&&q.typeOf(j.ExifVersion)==="array"){for(var h=0,k="";h<j.ExifVersion.length;h++){k+=String.fromCharCode(j.ExifVersion[h])}j.ExifVersion=k}return j},GPS:function(){var h;h=e(f.gpsIFD,g.gps);if(h.GPSVersionID){h.GPSVersionID=h.GPSVersionID.join(".")}return h},setExif:function(j,h){if(j!=="PixelXDimension"&&j!=="PixelYDimension"){return false}return c("exif",j,h)},getBinary:function(){return d.SEGMENT()}}}})(window,document,plupload);(function(j,g,f,k){function h(a){return g.getElementById(a)}f.runtimes.Html4=f.addRuntime("html4",{getFeatures:function(){return{multipart:true,triggerDialog:(f.ua.gecko&&j.FormData||f.ua.webkit)}},init:function(b,a){b.bind("Init",function(e){var E=g.body,A,F="javascript",D,H,d,G=[],c=/MSIE/.test(navigator.userAgent),L=[],B=e.settings.filters,y,C,M,I;no_type_restriction:for(y=0;y<B.length;y++){C=B[y].extensions.split(/,/);for(I=0;I<C.length;I++){if(C[I]==="*"){L=[];break no_type_restriction}M=f.mimeTypes[C[I]];if(M&&f.inArray(M,L)===-1){L.push(M)}}}L=L.join(",");function J(){var m,l,o,n;d=f.guid();G.push(d);m=g.createElement("form");m.setAttribute("id","form_"+d);m.setAttribute("method","post");m.setAttribute("enctype","multipart/form-data");m.setAttribute("encoding","multipart/form-data");m.setAttribute("target",e.id+"_iframe");m.style.position="absolute";l=g.createElement("input");l.setAttribute("id","input_"+d);l.setAttribute("type","file");l.setAttribute("accept",L);l.setAttribute("size",1);n=h(e.settings.browse_button);if(e.features.triggerDialog&&n){f.addEvent(h(e.settings.browse_button),"click",function(p){if(!l.disabled){l.click()}p.preventDefault()},e.id)}f.extend(l.style,{width:"100%",height:"100%",opacity:0,fontSize:"99px",cursor:"pointer"});f.extend(m.style,{overflow:"hidden"});o=e.settings.shim_bgcolor;if(o){m.style.background=o}if(c){f.extend(l.style,{filter:"alpha(opacity=0)"})}f.addEvent(l,"change",function(q){var s=q.target,t,r=[],p;if(s.value){h("form_"+d).style.top=-1048575+"px";t=s.value.replace(/\\/g,"/");t=t.substring(t.length,t.lastIndexOf("/")+1);r.push(new f.File(d,t));if(!e.features.triggerDialog){f.removeAllEvents(m,e.id)}else{f.removeEvent(n,"click",e.id)}f.removeEvent(l,"change",e.id);J();if(r.length){b.trigger("FilesAdded",r)}}},e.id);m.appendChild(l);E.appendChild(m);e.refresh()}function K(){var l=g.createElement("div");l.innerHTML='<iframe id="'+e.id+'_iframe" name="'+e.id+'_iframe" src="'+F+':&quot;&quot;" style="display:none"></iframe>';A=l.firstChild;E.appendChild(A);f.addEvent(A,"load",function(o){var n=o.target,p,m;if(!D){return}try{p=n.contentWindow.document||n.contentDocument||j.frames[n.id].document}catch(q){e.trigger("Error",{code:f.SECURITY_ERROR,message:f.translate("Security error."),file:D});return}m=p.body.innerHTML;if(m){D.status=f.DONE;D.loaded=1025;D.percent=100;e.trigger("UploadProgress",D);e.trigger("FileUploaded",D,{response:m})}},e.id)}if(e.settings.container){E=h(e.settings.container);if(f.getStyle(E,"position")==="static"){E.style.position="relative"}}e.bind("UploadFile",function(o,n){var m,l;if(n.status==f.DONE||n.status==f.FAILED||o.state==f.STOPPED){return}m=h("form_"+n.id);l=h("input_"+n.id);l.setAttribute("name",o.settings.file_data_name);m.setAttribute("action",o.settings.url);f.each(f.extend({name:n.target_name||n.name},o.settings.multipart_params),function(p,r){var q=g.createElement("input");f.extend(q,{type:"hidden",name:r,value:p});m.insertBefore(q,m.firstChild)});D=n;h("form_"+d).style.top=-1048575+"px";m.submit()});e.bind("FileUploaded",function(l){l.refresh()});e.bind("StateChanged",function(l){if(l.state==f.STARTED){K()}else{if(l.state==f.STOPPED){j.setTimeout(function(){f.removeEvent(A,"load",l.id);if(A.parentNode){A.parentNode.removeChild(A)}},0)}}f.each(l.files,function(o,m){if(o.status===f.DONE||o.status===f.FAILED){var n=h("form_"+o.id);if(n){n.parentNode.removeChild(n)}}})});e.bind("Refresh",function(o){var s,n,m,l,p,r,q,t,u;s=h(o.settings.browse_button);if(s){p=f.getPos(s,h(o.settings.container));r=f.getSize(s);q=h("form_"+d);t=h("input_"+d);f.extend(q.style,{top:p.y+"px",left:p.x+"px",width:r.w+"px",height:r.h+"px"});if(o.features.triggerDialog){if(f.getStyle(s,"position")==="static"){f.extend(s.style,{position:"relative"})}u=parseInt(s.style.zIndex,10);if(isNaN(u)){u=0}f.extend(s.style,{zIndex:u});f.extend(q.style,{zIndex:u-1})}m=o.settings.browse_button_hover;l=o.settings.browse_button_active;n=o.features.triggerDialog?s:q;if(m){f.addEvent(n,"mouseover",function(){f.addClass(s,m)},o.id);f.addEvent(n,"mouseout",function(){f.removeClass(s,m)},o.id)}if(l){f.addEvent(n,"mousedown",function(){f.addClass(s,l)},o.id);f.addEvent(g.body,"mouseup",function(){f.removeClass(s,l)},o.id)}}});b.bind("FilesRemoved",function(o,n){var l,m;for(l=0;l<n.length;l++){m=h("form_"+n[l].id);if(m){m.parentNode.removeChild(m)}}});b.bind("DisableBrowse",function(n,m){var l=g.getElementById("input_"+d);if(l){l.disabled=m}});b.bind("Destroy",function(p){var l,o,n,m={inputContainer:"form_"+d,inputFile:"input_"+d,browseButton:p.settings.browse_button};for(l in m){o=h(m[l]);if(o){f.removeAllEvents(o,p.id)}}f.removeAllEvents(g.body,p.id);f.each(G,function(q,r){n=h("form_"+q);if(n){E.removeChild(n)}})});J()});a({success:true})}})})(window,document,plupload);(function(f,e){function h(a,m){var l=a.nodeName.toLowerCase();if("area"===l){var k=a.parentNode,j=k.name,d;return !a.href||!j||k.nodeName.toLowerCase()!=="map"?!1:(d=f("img[usemap=#"+j+"]")[0],!!d&&g(d))}return(/input|select|textarea|button|object/.test(l)?!a.disabled:"a"==l?a.href||m:m)&&g(a)}function g(a){return !f(a).parents().andSelf().filter(function(){return f.curCSS(this,"visibility")==="hidden"||f.expr.filters.hidden(this)}).length}f.ui=f.ui||{};if(f.ui.version){return}f.extend(f.ui,{version:"1.8.20",keyCode:{ALT:18,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND:91,COMMAND_LEFT:91,COMMAND_RIGHT:93,CONTROL:17,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,INSERT:45,LEFT:37,MENU:93,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SHIFT:16,SPACE:32,TAB:9,UP:38,WINDOWS:91}}),f.fn.extend({propAttr:f.fn.prop||f.fn.attr,_focus:f.fn.focus,focus:function(a,d){return typeof a=="number"?this.each(function(){var b=this;setTimeout(function(){f(b).focus(),d&&d.call(b)},a)}):this._focus.apply(this,arguments)},scrollParent:function(){var a;return f.browser.msie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?a=this.parents().filter(function(){return/(relative|absolute|fixed)/.test(f.curCSS(this,"position",1))&&/(auto|scroll)/.test(f.curCSS(this,"overflow",1)+f.curCSS(this,"overflow-y",1)+f.curCSS(this,"overflow-x",1))}).eq(0):a=this.parents().filter(function(){return/(auto|scroll)/.test(f.curCSS(this,"overflow",1)+f.curCSS(this,"overflow-y",1)+f.curCSS(this,"overflow-x",1))}).eq(0),/fixed/.test(this.css("position"))||!a.length?f(document):a},zIndex:function(k){if(k!==e){return this.css("zIndex",k)}if(this.length){var j=f(this[0]),b,a;while(j.length&&j[0]!==document){b=j.css("position");if(b==="absolute"||b==="relative"||b==="fixed"){a=parseInt(j.css("zIndex"),10);if(!isNaN(a)&&a!==0){return a}}j=j.parent()}}return 0},disableSelection:function(){return this.bind((f.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(b){b.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),f.each(["Width","Height"],function(m,l){function a(n,q,p,o){return f.each(k,function(){q-=parseFloat(f.curCSS(n,"padding"+this,!0))||0,p&&(q-=parseFloat(f.curCSS(n,"border"+this+"Width",!0))||0),o&&(q-=parseFloat(f.curCSS(n,"margin"+this,!0))||0)}),q}var k=l==="Width"?["Left","Right"]:["Top","Bottom"],j=l.toLowerCase(),b={innerWidth:f.fn.innerWidth,innerHeight:f.fn.innerHeight,outerWidth:f.fn.outerWidth,outerHeight:f.fn.outerHeight};f.fn["inner"+l]=function(d){return d===e?b["inner"+l].call(this):this.each(function(){f(this).css(j,a(this,d)+"px")})},f.fn["outer"+l]=function(d,n){return typeof d!="number"?b["outer"+l].call(this,d):this.each(function(){f(this).css(j,a(this,d,!0,n)+"px")})}}),f.extend(f.expr[":"],{data:function(a,k,j){return !!f.data(a,j[3])},focusable:function(a){return h(a,!isNaN(f.attr(a,"tabindex")))},tabbable:function(a){var j=f.attr(a,"tabindex"),c=isNaN(j);return(c||j>=0)&&h(a,!c)}}),f(function(){var a=document.body,d=a.appendChild(d=document.createElement("div"));d.offsetHeight,f.extend(d.style,{minHeight:"100px",height:"auto",padding:0,borderWidth:0}),f.support.minHeight=d.offsetHeight===100,f.support.selectstart="onselectstart" in d,a.removeChild(d).style.display="none"}),f.extend(f.ui,{plugin:{add:function(a,m,l){var k=f.ui[a].prototype;for(var j in l){k.plugins[j]=k.plugins[j]||[],k.plugins[j].push([m,l[j]])}},call:function(k,j,n){var m=k.plugins[j];if(!m||!k.element[0].parentNode){return}for(var l=0;l<m.length;l++){k.options[m[l][0]]&&m[l][1].apply(k.element,n)}}},contains:function(d,c){return document.compareDocumentPosition?d.compareDocumentPosition(c)&16:d!==c&&d.contains(c)},hasScroll:function(a,l){if(f(a).css("overflow")==="hidden"){return !1}var k=l&&l==="left"?"scrollLeft":"scrollTop",j=!1;return a[k]>0?!0:(a[k]=1,j=a[k]>0,a[k]=0,j)},isOverAxis:function(j,d,k){return j>d&&j<d+k},isOver:function(a,n,m,l,k,j){return f.ui.isOverAxis(a,m,k)&&f.ui.isOverAxis(n,l,j)}})})(jQuery);(function(f,e){if(f.cleanData){var h=f.cleanData;f.cleanData=function(a){for(var k=0,j;(j=a[k])!=null;k++){try{f(j).triggerHandler("remove")}catch(c){}}h(a)}}else{var g=f.fn.remove;f.fn.remove=function(a,d){return this.each(function(){return d||(!a||f.filter(a,[this]).length)&&f("*",this).add([this]).each(function(){try{f(this).triggerHandler("remove")}catch(c){}}),g.call(f(this),a,d)})}}f.widget=function(a,n,m){var l=a.split(".")[0],k;a=a.split(".")[1],k=l+"-"+a,m||(m=n,n=f.Widget),f.expr[":"][k]=function(b){return !!f.data(b,a)},f[l]=f[l]||{},f[l][a]=function(d,c){arguments.length&&this._createWidget(d,c)};var j=new n;j.options=f.extend(!0,{},j.options),f[l][a].prototype=f.extend(!0,j,{namespace:l,widgetName:a,widgetEventPrefix:f[l][a].prototype.widgetEventPrefix||a,widgetBaseClass:k},m),f.widget.bridge(a,f[l][a])},f.widget.bridge=function(b,a){f.fn[b]=function(k){var j=typeof k=="string",d=Array.prototype.slice.call(arguments,1),c=this;return k=!j&&d.length?f.extend.apply(null,[!0,k].concat(d)):k,j&&k.charAt(0)==="_"?c:(j?this.each(function(){var m=f.data(this,b),l=m&&f.isFunction(m[k])?m[k].apply(m,d):m;if(l!==m&&l!==e){return c=l,!1}}):this.each(function(){var l=f.data(this,b);l?l.option(k||{})._init():f.data(this,b,new a(k,this))}),c)}},f.Widget=function(d,c){arguments.length&&this._createWidget(d,c)},f.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",options:{disabled:!1},_createWidget:function(a,k){f.data(k,this.widgetName,this),this.element=f(k),this.options=f.extend(!0,{},this.options,this._getCreateOptions(),a);var j=this;this.element.bind("remove."+this.widgetName,function(){j.destroy()}),this._create(),this._trigger("create"),this._init()},_getCreateOptions:function(){return f.metadata&&f.metadata.get(this.element[0])[this.widgetName]},_create:function(){},_init:function(){},destroy:function(){this.element.unbind("."+this.widgetName).removeData(this.widgetName),this.widget().unbind("."+this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass+"-disabled ui-state-disabled")},widget:function(){return this.element},option:function(j,b){var a=j;if(arguments.length===0){return f.extend({},this.options)}if(typeof j=="string"){if(b===e){return this.options[j]}a={},a[j]=b}return this._setOptions(a),this},_setOptions:function(a){var d=this;return f.each(a,function(j,c){d._setOption(j,c)}),this},_setOption:function(d,c){return this.options[d]=c,d==="disabled"&&this.widget()[c?"addClass":"removeClass"](this.widgetBaseClass+"-disabled ui-state-disabled").attr("aria-disabled",c),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_trigger:function(a,n,m){var l,k,j=this.options[a];m=m||{},n=f.Event(n),n.type=(a===this.widgetEventPrefix?a:this.widgetEventPrefix+a).toLowerCase(),n.target=this.element[0],k=n.originalEvent;if(k){for(l in k){l in n||(n[l]=k[l])}}return this.element.trigger(n,m),!(f.isFunction(j)&&j.call(this.element[0],n,m)===!1||n.isDefaultPrevented())}}})(jQuery);(function(e,d){var f=!1;e(document).mouseup(function(b){f=!1}),e.widget("ui.mouse",{options:{cancel:":input,option",distance:1,delay:0},_mouseInit:function(){var a=this;this.element.bind("mousedown."+this.widgetName,function(b){return a._mouseDown(b)}).bind("click."+this.widgetName,function(b){if(!0===e.data(b.target,a.widgetName+".preventClickEvent")){return e.removeData(b.target,a.widgetName+".preventClickEvent"),b.stopImmediatePropagation(),!1}}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(a){if(f){return}this._mouseStarted&&this._mouseUp(a),this._mouseDownEvent=a;var h=this,g=a.which==1,c=typeof this.options.cancel=="string"&&a.target.nodeName?e(a.target).closest(this.options.cancel).length:!1;if(!g||c||!this._mouseCapture(a)){return !0}this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){h.mouseDelayMet=!0},this.options.delay));if(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)){this._mouseStarted=this._mouseStart(a)!==!1;if(!this._mouseStarted){return a.preventDefault(),!0}}return !0===e.data(a.target,this.widgetName+".preventClickEvent")&&e.removeData(a.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(b){return h._mouseMove(b)},this._mouseUpDelegate=function(b){return h._mouseUp(b)},e(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),a.preventDefault(),f=!0,!0},_mouseMove:function(a){return !e.browser.msie||document.documentMode>=9||!!a.button?this._mouseStarted?(this._mouseDrag(a),a.preventDefault()):(this._mouseDistanceMet(a)&&this._mouseDelayMet(a)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,a)!==!1,this._mouseStarted?this._mouseDrag(a):this._mouseUp(a)),!this._mouseStarted):this._mouseUp(a)},_mouseUp:function(a){return e(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,a.target==this._mouseDownEvent.target&&e.data(a.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(a)),!1},_mouseDistanceMet:function(b){return Math.max(Math.abs(this._mouseDownEvent.pageX-b.pageX),Math.abs(this._mouseDownEvent.pageY-b.pageY))>=this.options.distance},_mouseDelayMet:function(b){return this.mouseDelayMet},_mouseStart:function(b){},_mouseDrag:function(b){},_mouseStop:function(b){},_mouseCapture:function(b){return !0}})})(jQuery);(function(d,c){d.widget("ui.sortable",d.ui.mouse,{widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1000},_create:function(){var b=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?b.axis==="x"||/left|right/.test(this.items[0].item.css("float"))||/inline|table-cell/.test(this.items[0].item.css("display")):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},destroy:function(){d.Widget.prototype.destroy.call(this),this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--){this.items[a].item.removeData(this.widgetName+"-item")}return this},_setOption:function(a,e){a==="disabled"?(this.options[a]=e,this.widget()[e?"addClass":"removeClass"]("ui-sortable-disabled")):d.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(a,o){var n=this;if(this.reverting){return !1}if(this.options.disabled||this.options.type=="static"){return !1}this._refreshItems(a);var m=null,l=this,k=d(a.target).parents().each(function(){if(d.data(this,n.widgetName+"-item")==l){return m=d(this),!1}});d.data(a.target,n.widgetName+"-item")==l&&(m=d(a.target));if(!m){return !1}if(this.options.handle&&!o){var j=!1;d(this.options.handle,m).find("*").andSelf().each(function(){this==a.target&&(j=!0)});if(!j){return !1}}return this.currentItem=m,this._removeCurrentsFromItems(),!0},_mouseStart:function(a,m,l){var k=this.options,j=this;this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(a),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),d.extend(this.offset,{click:{left:a.pageX-this.offset.left,top:a.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this._generatePosition(a),this.originalPageX=a.pageX,this.originalPageY=a.pageY,k.cursorAt&&this._adjustOffsetFromHelper(k.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!=this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),k.containment&&this._setContainment(),k.cursor&&(d("body").css("cursor")&&(this._storedCursor=d("body").css("cursor")),d("body").css("cursor",k.cursor)),k.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",k.opacity)),k.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",k.zIndex)),this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",a,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions();if(!l){for(var h=this.containers.length-1;h>=0;h--){this.containers[h]._trigger("activate",a,j._uiHash(this))}}return d.ui.ddmanager&&(d.ui.ddmanager.current=this),d.ui.ddmanager&&!k.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,a),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(a),!0},_mouseDrag:function(a){this.position=this._generatePosition(a),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs);if(this.options.scroll){var o=this.options,n=!1;this.scrollParent[0]!=document&&this.scrollParent[0].tagName!="HTML"?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-a.pageY<o.scrollSensitivity?this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop+o.scrollSpeed:a.pageY-this.overflowOffset.top<o.scrollSensitivity&&(this.scrollParent[0].scrollTop=n=this.scrollParent[0].scrollTop-o.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-a.pageX<o.scrollSensitivity?this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft+o.scrollSpeed:a.pageX-this.overflowOffset.left<o.scrollSensitivity&&(this.scrollParent[0].scrollLeft=n=this.scrollParent[0].scrollLeft-o.scrollSpeed)):(a.pageY-d(document).scrollTop()<o.scrollSensitivity?n=d(document).scrollTop(d(document).scrollTop()-o.scrollSpeed):d(window).height()-(a.pageY-d(document).scrollTop())<o.scrollSensitivity&&(n=d(document).scrollTop(d(document).scrollTop()+o.scrollSpeed)),a.pageX-d(document).scrollLeft()<o.scrollSensitivity?n=d(document).scrollLeft(d(document).scrollLeft()-o.scrollSpeed):d(window).width()-(a.pageX-d(document).scrollLeft())<o.scrollSensitivity&&(n=d(document).scrollLeft(d(document).scrollLeft()+o.scrollSpeed))),n!==!1&&d.ui.ddmanager&&!o.dropBehaviour&&d.ui.ddmanager.prepareOffsets(this,a)}this.positionAbs=this._convertPositionTo("absolute");if(!this.options.axis||this.options.axis!="y"){this.helper[0].style.left=this.position.left+"px"}if(!this.options.axis||this.options.axis!="x"){this.helper[0].style.top=this.position.top+"px"}for(var m=this.items.length-1;m>=0;m--){var l=this.items[m],k=l.item[0],j=this._intersectsWithPointer(l);if(!j){continue}if(k!=this.currentItem[0]&&this.placeholder[j==1?"next":"prev"]()[0]!=k&&!d.ui.contains(this.placeholder[0],k)&&(this.options.type=="semi-dynamic"?!d.ui.contains(this.element[0],k):!0)){this.direction=j==1?"down":"up";if(this.options.tolerance=="pointer"||this._intersectsWithSides(l)){this._rearrange(a,l)}else{break}this._trigger("change",a,this._uiHash());break}}return this._contactContainers(a),d.ui.ddmanager&&d.ui.ddmanager.drag(this,a),this._trigger("sort",a,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(a,h){if(!a){return}d.ui.ddmanager&&!this.options.dropBehaviour&&d.ui.ddmanager.drop(this,a);if(this.options.revert){var g=this,f=g.placeholder.offset();g.reverting=!0,d(this.helper).animate({left:f.left-this.offset.parent.left-g.margins.left+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollLeft),top:f.top-this.offset.parent.top-g.margins.top+(this.offsetParent[0]==document.body?0:this.offsetParent[0].scrollTop)},parseInt(this.options.revert,10)||500,function(){g._clear(a)})}else{this._clear(a,h)}return !1},cancel:function(){var a=this;if(this.dragging){this._mouseUp({target:null}),this.options.helper=="original"?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--){this.containers[e]._trigger("deactivate",null,a._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,a._uiHash(this)),this.containers[e].containerCache.over=0)}}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.options.helper!="original"&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),d.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?d(this.domPosition.prev).after(this.currentItem):d(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(a){var f=this._getItemsAsjQuery(a&&a.connected),e=[];return a=a||{},d(f).each(function(){var b=(d(a.item||this).attr(a.attribute||"id")||"").match(a.expression||/(.+)[-=_](.+)/);b&&e.push((a.key||b[1]+"[]")+"="+(a.key&&a.expression?b[1]:b[2]))}),!e.length&&a.key&&e.push(a.key+"="),e.join("&")},toArray:function(a){var f=this._getItemsAsjQuery(a&&a.connected),e=[];return a=a||{},f.each(function(){e.push(d(a.item||this).attr(a.attribute||"id")||"")}),e},_intersectsWith:function(x){var w=this.positionAbs.left,v=w+this.helperProportions.width,u=this.positionAbs.top,t=u+this.helperProportions.height,s=x.left,r=s+x.width,q=x.top,p=q+x.height,o=this.offset.click.top,n=this.offset.click.left,m=u+o>q&&u+o<p&&w+n>s&&w+n<r;return this.options.tolerance=="pointer"||this.options.forcePointerForContainers||this.options.tolerance!="pointer"&&this.helperProportions[this.floating?"width":"height"]>x[this.floating?"width":"height"]?m:s<w+this.helperProportions.width/2&&v-this.helperProportions.width/2<r&&q<u+this.helperProportions.height/2&&t-this.helperProportions.height/2<p},_intersectsWithPointer:function(a){var m=this.options.axis==="x"||d.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top,a.height),l=this.options.axis==="y"||d.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left,a.width),k=m&&l,j=this._getDragVerticalDirection(),h=this._getDragHorizontalDirection();return k?this.floating?h&&h=="right"||j=="down"?2:1:j&&(j=="down"?2:1):!1},_intersectsWithSides:function(a){var k=d.ui.isOverAxis(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),j=d.ui.isOverAxis(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),h=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return this.floating&&g?g=="right"&&j||g=="left"&&!j:h&&(h=="down"&&k||h=="up"&&!k)},_getDragVerticalDirection:function(){var b=this.positionAbs.top-this.lastPositionAbs.top;return b!=0&&(b>0?"down":"up")},_getDragHorizontalDirection:function(){var b=this.positionAbs.left-this.lastPositionAbs.left;return b!=0&&(b>0?"right":"left")},refresh:function(b){return this._refreshItems(b),this.refreshPositions(),this},_connectWith:function(){var b=this.options;return b.connectWith.constructor==String?[b.connectWith]:b.connectWith},_getItemsAsjQuery:function(r){var q=this,p=[],o=[],n=this._connectWith();if(n&&r){for(var m=n.length-1;m>=0;m--){var l=d(n[m]);for(var k=l.length-1;k>=0;k--){var a=d.data(l[k],this.widgetName);a&&a!=this&&!a.options.disabled&&o.push([d.isFunction(a.options.items)?a.options.items.call(a.element):d(a.options.items,a.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),a])}}}o.push([d.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):d(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]);for(var m=o.length-1;m>=0;m--){o[m][0].each(function(){p.push(this)})}return d(p)},_removeCurrentsFromItems:function(){var f=this.currentItem.find(":data("+this.widgetName+"-item)");for(var e=0;e<this.items.length;e++){for(var g=0;g<f.length;g++){f[g]==this.items[e].item[0]&&this.items.splice(e,1)}}},_refreshItems:function(z){this.items=[],this.containers=[this];var y=this.items,x=this,w=[[d.isFunction(this.options.items)?this.options.items.call(this.element[0],z,{item:this.currentItem}):d(this.options.items,this.element),this]],v=this._connectWith();if(v&&this.ready){for(var u=v.length-1;u>=0;u--){var t=d(v[u]);for(var s=t.length-1;s>=0;s--){var r=d.data(t[s],this.widgetName);r&&r!=this&&!r.options.disabled&&(w.push([d.isFunction(r.options.items)?r.options.items.call(r.element[0],z,{item:this.currentItem}):d(r.options.items,r.element),r]),this.containers.push(r))}}}for(var u=w.length-1;u>=0;u--){var q=w[u][1],p=w[u][0];for(var s=0,o=p.length;s<o;s++){var a=d(p[s]);a.data(this.widgetName+"-item",q),y.push({item:a,instance:q,width:0,height:0,left:0,top:0})}}},refreshPositions:function(a){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());for(var k=this.items.length-1;k>=0;k--){var j=this.items[k];if(j.instance!=this.currentContainer&&this.currentContainer&&j.item[0]!=this.currentItem[0]){continue}var h=this.options.toleranceElement?d(this.options.toleranceElement,j.item):j.item;a||(j.width=h.outerWidth(),j.height=h.outerHeight());var g=h.offset();j.left=g.left,j.top=g.top}if(this.options.custom&&this.options.custom.refreshContainers){this.options.custom.refreshContainers.call(this)}else{for(var k=this.containers.length-1;k>=0;k--){var g=this.containers[k].element.offset();this.containers[k].containerCache.left=g.left,this.containers[k].containerCache.top=g.top,this.containers[k].containerCache.width=this.containers[k].element.outerWidth(),this.containers[k].containerCache.height=this.containers[k].element.outerHeight()}}return this},_createPlaceholder:function(a){var h=a||this,g=h.options;if(!g.placeholder||g.placeholder.constructor==String){var f=g.placeholder;g.placeholder={element:function(){var e=d(document.createElement(h.currentItem[0].nodeName)).addClass(f||h.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];return f||(e.style.visibility="hidden"),e},update:function(j,e){if(f&&!g.forcePlaceholderSize){return}e.height()||e.height(h.currentItem.innerHeight()-parseInt(h.currentItem.css("paddingTop")||0,10)-parseInt(h.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(h.currentItem.innerWidth()-parseInt(h.currentItem.css("paddingLeft")||0,10)-parseInt(h.currentItem.css("paddingRight")||0,10))}}}h.placeholder=d(g.placeholder.element.call(h.element,h.currentItem)),h.currentItem.after(h.placeholder),g.placeholder.update(h,h.placeholder)},_contactContainers:function(r){var q=null,p=null;for(var o=this.containers.length-1;o>=0;o--){if(d.ui.contains(this.currentItem[0],this.containers[o].element[0])){continue}if(this._intersectsWith(this.containers[o].containerCache)){if(q&&d.ui.contains(this.containers[o].element[0],q.element[0])){continue}q=this.containers[o],p=o}else{this.containers[o].containerCache.over&&(this.containers[o]._trigger("out",r,this._uiHash(this)),this.containers[o].containerCache.over=0)}}if(!q){return}if(this.containers.length===1){this.containers[p]._trigger("over",r,this._uiHash(this)),this.containers[p].containerCache.over=1}else{if(this.currentContainer!=this.containers[p]){var n=10000,m=null,l=this.positionAbs[this.containers[p].floating?"left":"top"];for(var k=this.items.length-1;k>=0;k--){if(!d.ui.contains(this.containers[p].element[0],this.items[k].item[0])){continue}var a=this.items[k][this.containers[p].floating?"left":"top"];Math.abs(a-l)<n&&(n=Math.abs(a-l),m=this.items[k])}if(!m&&!this.options.dropOnEmpty){return}this.currentContainer=this.containers[p],m?this._rearrange(r,m,null,!0):this._rearrange(r,null,this.containers[p].element,!0),this._trigger("change",r,this._uiHash()),this.containers[p]._trigger("change",r,this._uiHash(this)),this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",r,this._uiHash(this)),this.containers[p].containerCache.over=1}}},_createHelper:function(a){var f=this.options,e=d.isFunction(f.helper)?d(f.helper.apply(this.element[0],[a,this.currentItem])):f.helper=="clone"?this.currentItem.clone():this.currentItem;return e.parents("body").length||d(f.appendTo!="parent"?f.appendTo:this.currentItem[0].parentNode)[0].appendChild(e[0]),e[0]==this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(e[0].style.width==""||f.forceHelperSize)&&e.width(this.currentItem.width()),(e[0].style.height==""||f.forceHelperSize)&&e.height(this.currentItem.height()),e},_adjustOffsetFromHelper:function(a){typeof a=="string"&&(a=a.split(" ")),d.isArray(a)&&(a={left:+a[0],top:+a[1]||0}),"left" in a&&(this.offset.click.left=a.left+this.margins.left),"right" in a&&(this.offset.click.left=this.helperProportions.width-a.right+this.margins.left),"top" in a&&(this.offset.click.top=a.top+this.margins.top),"bottom" in a&&(this.offset.click.top=this.helperProportions.height-a.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var a=this.offsetParent.offset();this.cssPosition=="absolute"&&this.scrollParent[0]!=document&&d.ui.contains(this.scrollParent[0],this.offsetParent[0])&&(a.left+=this.scrollParent.scrollLeft(),a.top+=this.scrollParent.scrollTop());if(this.offsetParent[0]==document.body||this.offsetParent[0].tagName&&this.offsetParent[0].tagName.toLowerCase()=="html"&&d.browser.msie){a={top:0,left:0}}return{top:a.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:a.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if(this.cssPosition=="relative"){var b=this.currentItem.position();return{top:b.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:b.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var a=this.options;a.containment=="parent"&&(a.containment=this.helper[0].parentNode);if(a.containment=="document"||a.containment=="window"){this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,d(a.containment=="document"?document:window).width()-this.helperProportions.width-this.margins.left,(d(a.containment=="document"?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]}if(!/^(document|window|parent)$/.test(a.containment)){var h=d(a.containment)[0],g=d(a.containment).offset(),f=d(h).css("overflow")!="hidden";this.containment=[g.left+(parseInt(d(h).css("borderLeftWidth"),10)||0)+(parseInt(d(h).css("paddingLeft"),10)||0)-this.margins.left,g.top+(parseInt(d(h).css("borderTopWidth"),10)||0)+(parseInt(d(h).css("paddingTop"),10)||0)-this.margins.top,g.left+(f?Math.max(h.scrollWidth,h.offsetWidth):h.offsetWidth)-(parseInt(d(h).css("borderLeftWidth"),10)||0)-(parseInt(d(h).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,g.top+(f?Math.max(h.scrollHeight,h.offsetHeight):h.offsetHeight)-(parseInt(d(h).css("borderTopWidth"),10)||0)-(parseInt(d(h).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top]}},_convertPositionTo:function(a,m){m||(m=this.position);var l=a=="absolute"?1:-1,k=this.options,j=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,h=/(html|body)/i.test(j[0].tagName);return{top:m.top+this.offset.relative.top*l+this.offset.parent.top*l-(d.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollTop():h?0:j.scrollTop())*l),left:m.left+this.offset.relative.left*l+this.offset.parent.left*l-(d.browser.safari&&this.cssPosition=="fixed"?0:(this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():h?0:j.scrollLeft())*l)}},_generatePosition:function(a){var p=this.options,o=this.cssPosition=="absolute"&&(this.scrollParent[0]==document||!d.ui.contains(this.scrollParent[0],this.offsetParent[0]))?this.offsetParent:this.scrollParent,n=/(html|body)/i.test(o[0].tagName);this.cssPosition=="relative"&&(this.scrollParent[0]==document||this.scrollParent[0]==this.offsetParent[0])&&(this.offset.relative=this._getRelativeOffset());var m=a.pageX,l=a.pageY;if(this.originalPosition){this.containment&&(a.pageX-this.offset.click.left<this.containment[0]&&(m=this.containment[0]+this.offset.click.left),a.pageY-this.offset.click.top<this.containment[1]&&(l=this.containment[1]+this.offset.click.top),a.pageX-this.offset.click.left>this.containment[2]&&(m=this.containment[2]+this.offset.click.left),a.pageY-this.offset.click.top>this.containment[3]&&(l=this.containment[3]+this.offset.click.top));if(p.grid){var k=this.originalPageY+Math.round((l-this.originalPageY)/p.grid[1])*p.grid[1];l=this.containment?k-this.offset.click.top<this.containment[1]||k-this.offset.click.top>this.containment[3]?k-this.offset.click.top<this.containment[1]?k+p.grid[1]:k-p.grid[1]:k:k;var j=this.originalPageX+Math.round((m-this.originalPageX)/p.grid[0])*p.grid[0];m=this.containment?j-this.offset.click.left<this.containment[0]||j-this.offset.click.left>this.containment[2]?j-this.offset.click.left<this.containment[0]?j+p.grid[0]:j-p.grid[0]:j:j}}return{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+(d.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollTop():n?0:o.scrollTop()),left:m-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+(d.browser.safari&&this.cssPosition=="fixed"?0:this.cssPosition=="fixed"?-this.scrollParent.scrollLeft():n?0:o.scrollLeft())}},_rearrange:function(h,g,m,l){m?m[0].appendChild(this.placeholder[0]):g.item[0].parentNode.insertBefore(this.placeholder[0],this.direction=="down"?g.item[0]:g.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var k=this,j=this.counter;window.setTimeout(function(){j==k.counter&&k.refreshPositions(!l)},0)},_clear:function(a,k){this.reverting=!1;var j=[],h=this;!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null;if(this.helper[0]==this.currentItem[0]){for(var g in this._storedCSS){if(this._storedCSS[g]=="auto"||this._storedCSS[g]=="static"){this._storedCSS[g]=""}}this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else{this.currentItem.show()}this.fromOutside&&!k&&j.push(function(b){this._trigger("receive",b,this._uiHash(this.fromOutside))}),(this.fromOutside||this.domPosition.prev!=this.currentItem.prev().not(".ui-sortable-helper")[0]||this.domPosition.parent!=this.currentItem.parent()[0])&&!k&&j.push(function(b){this._trigger("update",b,this._uiHash())});if(!d.ui.contains(this.element[0],this.currentItem[0])){k||j.push(function(b){this._trigger("remove",b,this._uiHash())});for(var g=this.containers.length-1;g>=0;g--){d.ui.contains(this.containers[g].element[0],this.currentItem[0])&&!k&&(j.push(function(b){return function(e){b._trigger("receive",e,this._uiHash(this))}}.call(this,this.containers[g])),j.push(function(b){return function(e){b._trigger("update",e,this._uiHash(this))}}.call(this,this.containers[g])))}}for(var g=this.containers.length-1;g>=0;g--){k||j.push(function(b){return function(e){b._trigger("deactivate",e,this._uiHash(this))}}.call(this,this.containers[g])),this.containers[g].containerCache.over&&(j.push(function(b){return function(e){b._trigger("out",e,this._uiHash(this))}}.call(this,this.containers[g])),this.containers[g].containerCache.over=0)}this._storedCursor&&d("body").css("cursor",this._storedCursor),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex",this._storedZIndex=="auto"?"":this._storedZIndex),this.dragging=!1;if(this.cancelHelperRemoval){if(!k){this._trigger("beforeStop",a,this._uiHash());for(var g=0;g<j.length;g++){j[g].call(this,a)}this._trigger("stop",a,this._uiHash())}return !1}k||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!=this.currentItem[0]&&this.helper.remove(),this.helper=null;if(!k){for(var g=0;g<j.length;g++){j[g].call(this,a)}this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){d.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(a){var e=a||this;return{helper:e.helper,placeholder:e.placeholder||d([]),position:e.position,originalPosition:e.originalPosition,offset:e.positionAbs,item:e.currentItem,sender:a?a.element:null}}}),d.extend(d.ui.sortable,{version:"1.8.20"})})(jQuery);